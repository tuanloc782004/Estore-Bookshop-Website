<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/extras/spring-security6"
	xmlns="http://www.w3.org/1999/xhtml">
<head th:replace="~{admin/layout/head::head}">
</head>
<body>

	<div class="wrapper">

		<div th:replace="~{admin/layout/sidebar::sidebar}"></div>

		<div class="main-panel">
			<nav th:replace="~{admin/layout/navbar::navbar}"></nav>

			<div class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="header">
									<div class="row align-items-center mb-3">
										<div class="col-md-4">
											<h4 class="title mb-0">List of Cart Items</h4>
										</div>
									</div>
									<div class="content table-responsive table-full-width">
										<table class="table table-hover table-striped">
											<thead>
												<tr>
													<th>Book Image</th>
													<th>Title</th>
													<th>Price</th>
													<th>Quantity</th>
													<th>Total Price</th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="cartItem : ${cartItems}">
													<td><img
														th:src="${cartItem.book.bookImages?.size() > 0 
															? cartItem.book.bookImages.iterator().next().imageUrl 
															: '/upload-dir/default-image/book-image.jfif'}"
														alt="Book Image" width="100" height="100"></td>
													<td th:text="${cartItem.book.title}"></td>
													<td><span th:if="${cartItem.book.discount > 0}"
														th:text="${#numbers.formatDecimal(cartItem.book.price, 2, 'POINT', 'COMMA') + ' $'}"
														style="text-decoration: line-through; color: red;"></span>
														<span
														th:text="${cartItem.book.discount > 0 
                    ? #numbers.formatDecimal(cartItem.book.price * (100 - cartItem.book.discount) / 100, 2, 'POINT', 'COMMA') + ' $'
                    : #numbers.formatDecimal(cartItem.book.price, 2, 'POINT', 'COMMA') + ' $'}"></span>
													</td>
													<td th:text="${cartItem.quantity}"></td>
													<td
														th:text="${#numbers.formatDecimal(cartItem.quantity * (cartItem.book.discount > 0 
                                    ? (cartItem.book.price * (100 - cartItem.book.discount) / 100)
                                    : cartItem.book.price), 2, 'POINT', 'COMMA') + ' $'}"></td>

												</tr>
											</tbody>
											<tfoot>
												<tr>
													<td colspan="3">Total Quantity</td>
													<td th:text="${totalQuantity}"></td>
													<td></td>
												</tr>
												<tr>
													<td colspan="4">Total Price</td>
													<td th:text="${totalPrice} + ' $'"></td>
												</tr>
											</tfoot>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
		<div th:replace="~{admin/layout/script::script}"></div>
	</div>

</body>
</html>
